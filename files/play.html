<!DOCTYPE html>
<html lang="en">

<head>
	<title>%s | Text Adventure Game Creator</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="navbar.css">
</head>

<body>
	%s
	<div class="container">
		<p>%s</p>
		<p>%s</p>
		<form method="get" action="/play" autocomplete="off">
			<input id="command" name="cmd" autofocus>
			<input hidden value="%s" name="gameState">
			<input type="submit" id="submit" value="Submit">
		</form>
		<p>%s</p>
		<a href="/start?game=%d"><button>Restart this game</button></a>
	</div>
</body>

<script>
	const navbar = document.getElementById('navbar'),
		input = document.getElementById('command'),
		submit_button = document.getElementById('submit'),
		valid_cmd = /^(?:go|use|get|grab|pick up) ./i;

	try {
		if (window.self !== window.top) navbar.hidden = true;
	} catch (e) {
		navbar.hidden = true;
	}

	submit_button.disabled = true;
	input.addEventListener('input', () => {
		submit_button.disabled = !valid_cmd.test(input.value);
	});

	if (!navbar.hidden) {
		if (!localStorage.saved_games) localStorage.saved_games = '{}';
		const saved_games = JSON.parse(localStorage.saved_games);
		saved_games['%d'] = document.querySelector('input[name="gameState"]').value;
		localStorage.saved_games = JSON.stringify(saved_games);
	}
</script>

</html>